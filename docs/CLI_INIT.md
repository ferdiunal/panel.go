# Panel CLI - Init Komutu

`panel init` komutu, yeni bir Panel.go projesini başlatır ve gerekli tüm dosyaları oluşturur.

## Özellikler

- Proje başlangıç dosyalarını otomatik oluşturur
- Veritabanı seçimine göre özelleştirilmiş kod üretir
- Stub dosyalarını `.panel/stubs/` dizinine kopyalar
- Claude Code skill'lerini `.claude/skills/` dizinine kopyalar
- Otomatik encryption key oluşturur

## Kullanım

### İnteraktif Mod (Önerilen)

```bash
panel init
```

Komut çalıştırıldığında, kullanıcıya veritabanı seçimi için interaktif bir prompt gösterilir:

```
Select database driver:
  1. SQLite (default, file-based)
  2. PostgreSQL (recommended for production)
  3. MySQL

Enter choice [1-3] (default: 1):
```

### Flag ile Kullanım

Veritabanı seçimini flag ile de belirtebilirsiniz:

```bash
# SQLite ile (default)
panel init --database sqlite
panel init -d sqlite

# PostgreSQL ile
panel init --database postgres
panel init -d postgres

# MySQL ile
panel init --database mysql
panel init -d mysql
```

## Desteklenen Veritabanları

### 1. SQLite (Default)

**Avantajlar:**
- Kurulum gerektirmez
- Dosya tabanlı, kolay yedekleme
- Geliştirme için ideal

**Dezavantajlar:**
- Sınırlı eşzamanlılık
- Production için önerilmez

**Oluşturulan DSN:**
```env
DATABASE_DRIVER=sqlite
DATABASE_DSN=proje-adi.db
```

### 2. PostgreSQL (Production için önerilen)

**Avantajlar:**
- Güçlü ACID uyumluluğu
- Gelişmiş özellikler (JSON, full-text search)
- Yüksek performans ve ölçeklenebilirlik

**Dezavantajlar:**
- Ayrı sunucu kurulumu gerektirir

**Oluşturulan DSN:**
```env
DATABASE_DRIVER=postgres
DATABASE_DSN=host=localhost user=postgres password=postgres dbname=proje-adi port=5432 sslmode=disable TimeZone=UTC
```

### 3. MySQL

**Avantajlar:**
- Yaygın kullanım
- İyi dokümantasyon
- Çok sayıda hosting desteği

**Dezavantajlar:**
- PostgreSQL'e göre daha az özellik

**Oluşturulan DSN:**
```env
DATABASE_DRIVER=mysql
DATABASE_DSN=user:password@tcp(localhost:3306)/proje-adi?charset=utf8mb4&parseTime=True&loc=Local
```

## Oluşturulan Dosyalar

### 1. main.go

Seçilen veritabanına göre özelleştirilmiş `main.go` dosyası oluşturulur:

**SQLite için:**
```go
import (
    "gorm.io/driver/sqlite"
    "gorm.io/gorm"
)

func main() {
    // SQLite veritabanı bağlantısı
    db, err := gorm.Open(sqlite.Open("proje-adi.db"), &gorm.Config{})
    // ...
}
```

**PostgreSQL için:**
```go
import (
    "gorm.io/driver/postgres"
    "gorm.io/gorm"
)

func main() {
    // PostgreSQL veritabanı bağlantısı
    dsn := os.Getenv("DATABASE_DSN")
    db, err := gorm.Open(postgres.Open(dsn), &gorm.Config{})
    // ...
}
```

**MySQL için:**
```go
import (
    "gorm.io/driver/mysql"
    "gorm.io/gorm"
)

func main() {
    // MySQL veritabanı bağlantısı
    dsn := os.Getenv("DATABASE_DSN")
    db, err := gorm.Open(mysql.Open(dsn), &gorm.Config{})
    // ...
}
```

### 2. go.mod

Go module tanımı:

```go
module proje-adi

go 1.23

require (
    github.com/ferdiunal/panel.go v0.1.0
    // ...
)
```

### 3. .env

Seçilen veritabanına göre özelleştirilmiş environment konfigürasyonu:

```env
# Cookie Encryption Key (otomatik oluşturulur)
COOKIE_ENCRYPTION_KEY=<auto-generated-key>

# Database Configuration (seçilen veritabanına göre)
DATABASE_DRIVER=postgres
DATABASE_DSN=host=localhost user=postgres password=postgres dbname=proje-adi port=5432 sslmode=disable TimeZone=UTC

# Server Configuration
HOST=localhost
PORT=8080

# Environment
ENVIRONMENT=development
```

### 4. .gitignore

Standart Go ve Panel.go için `.gitignore` dosyası:

```gitignore
# Binaries
*.exe
*.dll
*.so
*.dylib
*.db

# Environment
.env

# Storage
storage/

# IDE
.vscode/
.idea/
```

### 5. .panel/stubs/

Kod oluşturma şablonları:
- `resource.stub` - Resource şablonu
- `policy.stub` - Policy şablonu
- `repository.stub` - Repository şablonu
- `model.stub` - Model şablonu
- `page.stub` - Page şablonu
- `field_resolver.stub` - Field resolver şablonu
- `card_resolver.stub` - Card resolver şablonu

### 6. .claude/skills/

Claude Code skill'leri:
- `panel-go-resource/` - Resource oluşturma skill'i
- `panel-go-field-resolver/` - Field resolver skill'i
- `panel-go-policy/` - Policy skill'i
- `panel-go-relationship/` - Relationship skill'i
- `panel-go-migration/` - Migration skill'i

## Proje Yapısı

Init komutu çalıştırıldıktan sonra proje yapısı:

```
proje-adi/
├── main.go              # Uygulama giriş noktası
├── go.mod               # Go module tanımı
├── .env                 # Environment konfigürasyonu
├── .gitignore           # Git ignore kuralları
├── .panel/
│   └── stubs/           # Kod oluşturma şablonları
└── .claude/
    └── skills/          # Claude Code skill'leri
```

## Sonraki Adımlar

Init komutu tamamlandıktan sonra:

### 1. Environment Konfigürasyonu

`.env` dosyasını düzenleyin ve veritabanı bağlantı bilgilerini güncelleyin:

**PostgreSQL için:**
```env
DATABASE_DSN=host=localhost user=your_user password=your_password dbname=proje-adi port=5432 sslmode=disable TimeZone=UTC
```

**MySQL için:**
```env
DATABASE_DSN=your_user:your_password@tcp(localhost:3306)/proje-adi?charset=utf8mb4&parseTime=True&loc=Local
```

### 2. Bağımlılıkları Yükleyin

```bash
go mod tidy
```

### 3. Uygulamayı Çalıştırın

```bash
go run main.go
```

Uygulama `http://localhost:8080` adresinde çalışmaya başlayacaktır.

### 4. İlk Resource'u Oluşturun

```bash
panel make:resource blog
```

veya Claude Code skill'i ile:

```
/panel-go-resource
```

## Örnekler

### Örnek 1: SQLite ile Hızlı Başlangıç

```bash
# Proje dizini oluştur
mkdir my-panel-app
cd my-panel-app

# Projeyi başlat (SQLite default)
panel init

# Bağımlılıkları yükle
go mod tidy

# Uygulamayı çalıştır
go run main.go
```

### Örnek 2: PostgreSQL ile Production Projesi

```bash
# Proje dizini oluştur
mkdir my-production-app
cd my-production-app

# PostgreSQL ile başlat
panel init --database postgres

# .env dosyasını düzenle
nano .env

# Bağımlılıkları yükle
go mod tidy

# Uygulamayı çalıştır
go run main.go
```

### Örnek 3: MySQL ile Mevcut Veritabanı

```bash
# Proje dizini oluştur
mkdir my-mysql-app
cd my-mysql-app

# MySQL ile başlat
panel init -d mysql

# .env dosyasını mevcut MySQL bilgileriyle güncelle
nano .env

# Bağımlılıkları yükle
go mod tidy

# Uygulamayı çalıştır
go run main.go
```

## Encryption Key

Init komutu, cookie encryption için otomatik olarak güvenli bir key oluşturur:

```bash
openssl rand -base64 32
```

Bu key `.env` dosyasında `COOKIE_ENCRYPTION_KEY` olarak saklanır.

**Önemli:** Production ortamında bu key'i güvenli bir şekilde saklayın ve asla version control'e commit etmeyin.

## Stub Dosyalarını Özelleştirme

Oluşturulan stub dosyalarını projenize özel olarak özelleştirebilirsiniz:

1. `.panel/stubs/` dizinindeki stub dosyalarını düzenleyin
2. Sonraki `make:*` komutları bu özelleştirilmiş stub'ları kullanacaktır

Örnek:
```bash
# Resource stub'ını özelleştir
nano .panel/stubs/resource.stub

# Yeni resource oluştur (özelleştirilmiş stub kullanılır)
panel make:resource post
```

## Sorun Giderme

### Veritabanı Bağlantı Hatası

**Hata:**
```
Failed to connect to database: dial tcp [::1]:5432: connect: connection refused
```

**Çözüm:**
1. Veritabanı sunucusunun çalıştığından emin olun
2. `.env` dosyasındaki bağlantı bilgilerini kontrol edin
3. Firewall kurallarını kontrol edin

### Encryption Key Hatası

**Hata:**
```
Warning: Failed to generate encryption key
```

**Çözüm:**
1. `openssl` komutunun yüklü olduğundan emin olun
2. Manuel olarak key oluşturun:
   ```bash
   openssl rand -base64 32
   ```
3. Oluşturulan key'i `.env` dosyasına ekleyin

### Go Module Hatası

**Hata:**
```
go: cannot find main module
```

**Çözüm:**
1. Proje dizininde olduğunuzdan emin olun
2. `go.mod` dosyasının oluşturulduğunu kontrol edin
3. `go mod tidy` komutunu çalıştırın

## İlgili Komutlar

- `panel make:resource` - Yeni resource oluşturur
- `panel make:page` - Yeni sayfa oluşturur
- `panel make:model` - Yeni model oluşturur
- `panel publish:stubs` - Stub dosyalarını yeniden yayınlar
- `panel publish:skills` - Skill dosyalarını yeniden yayınlar

## Referanslar

- [Getting Started](Getting-Started.md)
- [Resources](Resources.md)
- [Plugin CLI](PLUGIN_CLI.md)
